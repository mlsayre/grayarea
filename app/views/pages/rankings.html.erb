<div class="gametop"><span class="gtoneline">Rankings</span></div>

<div class="rankweeklycontent">
	<%= render "weeklyranks" %>
</div>

<div class="rankalltimecontent rankhidden">
	<%= render "alltimeranks" %>
</div>

<div class="rankyou rankhidden">
	<div class="lifetimerankings">
		<div class="rankingstabletitle">Your Stats</div>
		<span class="statcat"><u>Your Cheat Score (your games receiving 3+ cheat reports)</u></span>
		<span style="text-align: center; display:block;"><%= current_user.lifetimecheatgames %></span>

		<span class="statcat"><u>Games You've Reported</u></span>
		<span style="text-align: center; display:block;"><%= current_user.lifetimecheatreports %></span>
	</div>
</div>

<div class="centered">
	<button class="button returntomain"><img src="/assets/Home-48.png"></button>
</div>

<div class="rankbuttons">
	<button class="button ranktime rtweekly rankselected">Weekly</button>
	<button class="button ranktime rtalltime">All-time</button>
	<button class="button ranktime rtyou">You</button>
</div>

<script>
$(".rtweekly").click(function() {
	$(".ranktime").removeClass("rankselected");
	$(this).addClass("rankselected");
	$(".rankweeklycontent").removeClass("rankhidden");
	$(".rankalltimecontent").addClass("rankhidden");
	$(".rankyou").addClass("rankhidden");
})
$(".rtalltime").click(function() {
	$(".ranktime").removeClass("rankselected");
	$(this).addClass("rankselected");
	$(".rankweeklycontent").addClass("rankhidden");
	$(".rankalltimecontent").removeClass("rankhidden");
	$(".rankyou").addClass("rankhidden");
})
$(".rtyou").click(function() {
	$(".ranktime").removeClass("rankselected");
	$(this).addClass("rankselected");
	$(".rankweeklycontent").addClass("rankhidden");
	$(".rankalltimecontent").addClass("rankhidden");
	$(".rankyou").removeClass("rankhidden");
})

$(".weeklystats .next").click(function() {
	if ($(".showstat").next(".weeklystats .statcontainer").length === 0) {
		$(".weeklystats .showstat").addClass("statleaving");
		$(".weeklystats .statcontainer").first().find("ul, .statcat").addClass("slidetoright");
		$(".weeklystats .showstat ul, .weeklystats .showstat .statcat").addClass("slidetoleft");
		setTimeout(function() {
			$(".weeklystats .showstat.statleaving").removeClass("showstat").removeClass("statleaving");
			$(".weeklystats .statcontainer").first().addClass("showstat");
			setTimeout(function() {
				$(".slidetoright").removeClass("slidetoright");
				$(".slidetoleft").removeClass("slidetoleft");
			},120)
		}, 120)
	} else {
		$(".weeklystats .showstat").addClass("statleaving");
		$(".weeklystats .showstat").next(".statcontainer").find("ul, .statcat").addClass("slidetoright");
		$(".weeklystats .showstat ul, .weeklystats .showstat .statcat").addClass("slidetoleft");
		setTimeout(function() {
			$(".weeklystats .showstat.statleaving").removeClass("showstat").removeClass("statleaving")
			  .next(".statcontainer").addClass("showstat");
			setTimeout(function() {
				$(".slidetoright").removeClass("slidetoright");
				$(".slidetoleft").removeClass("slidetoleft");
			},120)
		}, 120)
	}
})

$(".weeklystats .prev").click(function() {
	if ($(".showstat").prev(".weeklystats .statcontainer").length === 0) {
		$(".weeklystats .showstat").addClass("statleaving");
		$(".weeklystats .statcontainer").last().find("ul, .statcat").addClass("slidetoleft");
		$(".weeklystats .showstat ul, .weeklystats .showstat .statcat").addClass("slidetoright");
		setTimeout(function() {
			$(".weeklystats .showstat.statleaving").removeClass("showstat").removeClass("statleaving");
			$(".weeklystats .statcontainer").last().addClass("showstat");
			setTimeout(function() {
				$(".slidetoright").removeClass("slidetoright");
				$(".slidetoleft").removeClass("slidetoleft");
			},120)
		}, 120)
	} else {
		$(".weeklystats .showstat").addClass("statleaving");
		$(".weeklystats .showstat").prev(".statcontainer").find("ul, .statcat").addClass("slidetoleft");
		$(".weeklystats .showstat ul, .weeklystats .showstat .statcat").addClass("slidetoright");
		setTimeout(function() {
			$(".weeklystats .showstat.statleaving").removeClass("showstat").removeClass("statleaving")
			  .prev(".statcontainer").addClass("showstat");
			setTimeout(function() {
				$(".slidetoright").removeClass("slidetoright");
				$(".slidetoleft").removeClass("slidetoleft");
			},120)
		}, 120)
	}
})

$(document).on("click", ".alltimestats .next", function() {
	if ($(".showstat").next(".alltimestats .statcontainer").length === 0) {
		$(".alltimestats .showstat").addClass("statleaving");
		$(".alltimestats .statcontainer").first().find("ul, .statcat").addClass("slidetoright");
		$(".alltimestats .showstat ul, .alltimestats .showstat .statcat").addClass("slidetoleft");
		setTimeout(function() {
			$(".alltimestats .showstat.statleaving").removeClass("showstat").removeClass("statleaving");
			$(".alltimestats .statcontainer").first().addClass("showstat");
			setTimeout(function() {
				$(".slidetoright").removeClass("slidetoright");
				$(".slidetoleft").removeClass("slidetoleft");
			},120)
		}, 120)
	} else {
		$(".alltimestats .showstat").addClass("statleaving");
		$(".alltimestats .showstat").next(".statcontainer").find("ul, .statcat").addClass("slidetoright");
		$(".alltimestats .showstat ul, .alltimestats .showstat .statcat").addClass("slidetoleft");
		setTimeout(function() {
			$(".alltimestats .showstat.statleaving").removeClass("showstat").removeClass("statleaving")
			  .next(".statcontainer").addClass("showstat");
			setTimeout(function() {
				$(".slidetoright").removeClass("slidetoright");
				$(".slidetoleft").removeClass("slidetoleft");
			},120)
		}, 120)
	}
})

$(document).on("click", ".alltimestats .prev", function() {
	if ($(".showstat").prev(".alltimestats .statcontainer").length === 0) {
		$(".alltimestats .showstat").addClass("statleaving");
		$(".alltimestats .statcontainer").last().find("ul, .statcat").addClass("slidetoleft");
		$(".alltimestats .showstat ul, .alltimestats .showstat .statcat").addClass("slidetoright");
		setTimeout(function() {
			$(".alltimestats .showstat.statleaving").removeClass("showstat").removeClass("statleaving");
			$(".alltimestats .statcontainer").last().addClass("showstat");
			setTimeout(function() {
				$(".slidetoright").removeClass("slidetoright");
				$(".slidetoleft").removeClass("slidetoleft");
			},120)
		}, 120)
	} else {
		$(".alltimestats .showstat").addClass("statleaving");
		$(".alltimestats .showstat").prev(".statcontainer").find("ul, .statcat").addClass("slidetoleft");
		$(".alltimestats .showstat ul, .alltimestats .showstat .statcat").addClass("slidetoright");
		setTimeout(function() {
			$(".alltimestats .showstat.statleaving").removeClass("showstat").removeClass("statleaving")
			  .prev(".statcontainer").addClass("showstat");
			setTimeout(function() {
				$(".slidetoright").removeClass("slidetoright");
				$(".slidetoleft").removeClass("slidetoleft");
			},120)
		}, 120)
	}
})

$(window).on('turbolinks:load', function() {
	var curusername = "<%= current_user.username %>";
	$(".statcontainer li").each(function() {
  	if ($(this).data("uname") === curusername) {
  		$(this).css("color", "red").css("box-shadow", "red 0px 0px 3px 0px inset");
  	}
  })

  alltimeload(["atcombined", "atgiver", "atguesser"], 250);
  weeklyload(["wkgiver", "wkguesser"], 250);
  weeklyload(["wktopgivers", "wktopguessers"], 500);
  alltimeload(["athearts", "atfeat", "atnonspoiler"], 750);
  alltimeload(["attopgivers", "attopguessers"], 600);
	

	function alltimeload(containers, time) {
		for (var i = 0; i < containers.length; i++) {
			(function() {
				var container = containers[i];
				setTimeout(function() {
					var wrapper = $("." + container);
					wrapper.load("/pages/alltimeranks" + " ." + container, function() {
					   wrapper.children("." + container).unwrap();
					   var curusername = "<%= current_user.username %>";
						  $("." + container + " li").each(function() {
						  	if ($(this).data("uname") === curusername) {
						  		$(this).css("color", "red").css("box-shadow", "red 0px 0px 3px 0px inset");
						  	}
						  })

					});
				}, time)
			})();
		}
	}

	function weeklyload(containers, time) {
		for (var i = 0; i < containers.length; i++) {
			(function() {
				var container = containers[i];
				setTimeout(function() {
					var wrapper = $("." + container);
					wrapper.load("/pages/weeklyranks" + " ." + container, function() {
					   wrapper.children("." + container).unwrap();
					   var curusername = "<%= current_user.username %>";
						  $("." + container + " li").each(function() {
						  	if ($(this).data("uname") === curusername) {
						  		$(this).css("color", "red").css("box-shadow", "red 0px 0px 3px 0px inset");
						  	}
						  })

					});
				}, time)
			})();
		}
	}
})
</script>